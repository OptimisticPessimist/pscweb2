{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="{% static 'css/base.css' %}" rel="stylesheet">
</head>

<body style="margin: 10px;">

<h2>{{ object.date|date:"m/d(D)" }} {{ object.start_time}}-{{object.end_time}}<br>
{{ object.place }}</h2>

<h3>欠席の人</h3>
<ul>
{% for abs_actor in abs_list %}
<li>{{ abs_actor }}</li>
{% endfor %}
</ul>

<h3>未定の人</h3>
<ul>
{% for und_actor in und_list %}
<li>{{ und_actor }}</li>
{% endfor %}
</ul>

<input type="button" onclick="copy();" value="クリップボードにコピー">

<script>
function copy(){
    var str = "【欠席の人】\n{% for abs_actor in abs_list %}{{ abs_actor }}\n{% endfor %}";
    {% if und_list %}
    str += "\n【未定の人】\n{% for und_actor in und_list %}{{ und_actor }}\n{% endfor %}";
    {% endif %}
    
    var listener = function(e){
        e.clipboardData.setData("text/plain" , str);    
        // 本来のイベントをキャンセル
        e.preventDefault();
        // リスナーを削除
        document.removeEventListener("copy", listener);
    }

    // コピーイベントが発生したときに、クリップボードに書き込むようにしておく
    document.addEventListener("copy" , listener);

    // コピーイベントを起こす
    document.execCommand("copy");
}
</script>
</body>
</html>
